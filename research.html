<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <meta name="description" content="">
        <meta name="author" content="">

        <title>Department of Communication, Yonsei University</title>

        <!-- CSS FILES -->        
        <link href="css/bootstrap.min.css" rel="stylesheet">

        <link href="css/bootstrap-icons.css" rel="stylesheet">

        <link href="css/templatemo-kind-heart-charity.css" rel="stylesheet">

        <!-- Template Stylesheet -->
        <link href="css/style.css" rel="stylesheet">

        <!-- Font Awesome CDN -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

        <style>
        .pub-topbar { display:flex; gap:.75rem; align-items:center; justify-content:space-between; flex-wrap:wrap; }
        .pub-topbar .search { max-width:360px; }
        .pub-meta { color:#6c757d; font-size:.9rem; }
        .pub-item a { text-decoration:none; color:#124878;}
        .pub-item a:hover { text-decoration:underline; }
        .pub-count { font-size:.85rem; color:#6c757d; }
        .pub-item { line-height: 1.55; }
        .pub-cite em { font-style: italic; }
        .pub-cite a { font-weight: 600; }
        .pub-cite .small { font-size: .85rem; }
        /* 하이라이트 대상 저자 */
        .author-hl{
          text-decoration: underline;
          text-decoration-color: #124878;
          text-decoration-thickness: 2px;
          text-underline-offset: 3px;
          color: #124878;
          font-weight: 600;
        }
                </style>

    </head>
    
    <body id="section_1">


        <nav class="navbar navbar-expand-lg bg-light shadow-lg">
            <div class="container">
                <a class="navbar-brand" href="index.html">
                    <img src="images/logo.png" class="logo img-fluid" alt="Department of Communication" style="width:8%; height:auto;">
                    <span>
                        언론홍보영상학부
                        <small>Department of Communication</small>
                    </span>
                </a>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">

                        <li class="nav-item dropdown">
                            <a class="nav-link click-scroll dropdown-toggle" href="#section_2" id="navbarLightDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">학부소개</a>

                            <ul class="dropdown-menu dropdown-menu-light" aria-labelledby="navbarLightDropdownMenuLink">
                                <li><a class="dropdown-item" href="intro.html">인사말</a></li>
                                <li><a class="dropdown-item" href="intro.html#more_history">학과연혁</a></li>
                                <li><a class="dropdown-item" href="index.html#section_5">주요시설안내</a></li>
                                <li><a class="dropdown-item" href="index.html#section_6">찾아오시는길</a></li>

                            </ul>
                        </li>

                        <li class="nav-item dropdown">
                            <a class="nav-link click-scroll dropdown-toggle" href="#section_2" id="navbarLightDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">구성원</a>

                            <ul class="dropdown-menu dropdown-menu-light" aria-labelledby="navbarLightDropdownMenuLink">
                                <li><a class="dropdown-item" href="people.html">현직교수</a></li>
                                <li><a class="dropdown-item" href="people_emeritus.html">명예교수</a></li>
                                <li><a class="dropdown-item" href="people_emeritus.html#section_2">퇴임교수</a></li>
                                <li><a class="dropdown-item" href="people_profpractice.html">비전임/겸임교수</a></li>

                            </ul>
                        </li>


                        <li class="nav-item dropdown">
                            <a class="nav-link click-scroll dropdown-toggle" href="#section_4" id="navbarLightDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">학사안내</a>

                            <ul class="dropdown-menu dropdown-menu-light" aria-labelledby="navbarLightDropdownMenuLink">

                                <li><a class="dropdown-item" href="https://www.yonsei.ac.kr/sc/2347/subview.do" target="_blank">입학안내</a></li>
                                <li><a class="dropdown-item" href="https://www.yonsei.ac.kr/sc/373/subview.do" target="_blank">학사일정</a></li>
                                <li><a class="dropdown-item" href="curriculum.html">교과과정</a></li>
                                <li><a class="dropdown-item" href="curriculum.html#graduation-requirement">졸업요건</a></li>
                                <li><a class="dropdown-item" href="scholarship.html">장학</a></li>
                                <li><a class="dropdown-item" href="https://www.yonsei.ac.kr/sc/383/subview.do" target="_blank">복수전공/부전공</a></li>
                                <li><a class="dropdown-item" href="https://oia.yonsei.ac.kr/partner/chStu.asp" target="_blank">교환학생/학점인정</a></li>

                            </ul>
                        </li>


                        <li class="nav-item dropdown">
                            <a class="nav-link click-scroll dropdown-toggle" href="#section_4" id="navbarLightDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">연구/국제</a>

                            <ul class="dropdown-menu dropdown-menu-light" aria-labelledby="navbarLightDropdownMenuLink">

                                <li><a class="dropdown-item" href="research.html" target="">연구분야</a></li>
                                <li><a class="dropdown-item" href="research_institute.html" target="">연구소/대형센터</a></li>
                                <li><a class="dropdown-item" href="yonsei_uva.html">Yonsei-UvA</a></li>
                                <li><a class="dropdown-item" href="yonsei_cityu.html">CityU 복수학위</a></li>

                            </ul>
                        </li>


                        <li class="nav-item dropdown">
                            <a class="nav-link click-scroll dropdown-toggle" href="#section_5" id="navbarLightDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">일반대학원</a>

                            <ul class="dropdown-menu dropdown-menu-light" aria-labelledby="navbarLightDropdownMenuLink">
                                <li><a class="dropdown-item" href="https://graduate.yonsei.ac.kr/graduate/admission/schedule.do" target="_blank">입학안내</a></li>
                                <li><a class="dropdown-item" href="https://graduate.yonsei.ac.kr/graduate/admission/connect_schedule.do" target="_blank">학석사연계</a></li>
                                <li><a class="dropdown-item" href="https://graduate.yonsei.ac.kr/graduate/academic/calendar.do" target="_blank">학사일정</a></li>
                                <li><a class="dropdown-item" href="curriculum_graduate.html">교과과정</a></li>
                                <li><a class="dropdown-item" href="curriculum_graduate.html#graduation-requirement">졸업요건</a></li>
                            </ul>
                        </li>

                        <li class="nav-item dropdown">
                            <a class="nav-link click-scroll dropdown-toggle" href="#section_6" id="navbarLightDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">특수전문대학원</a>

                            <ul class="dropdown-menu dropdown-menu-light" aria-labelledby="navbarLightDropdownMenuLink">
                                <li><a class="dropdown-item" href="https://jmc.yonsei.ac.kr/jmc/index.do" target="_blank">언론홍보대학원</a></li>
                                <li><a class="dropdown-item" href="https://www.yjs.or.kr/html/main.php" target="_blank">윤세영저널리즘스쿨</a></li>
                                <li><a class="dropdown-item" href="https://jmc.yonsei.ac.kr/jmc/jmc01/high01.do" target="_blank">언홍원 최고위과정</a></li>
                            </ul>
                        </li>

                        <li class="nav-item dropdown">
                            <a class="nav-link click-scroll dropdown-toggle" href="#" id="navbarLightDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">공지사항</a>

                            <ul class="dropdown-menu dropdown-menu-light" aria-labelledby="navbarLightDropdownMenuLink">
                                <li><a class="dropdown-item" href="notice.html">학사공지</a></li>
                                <li><a class="dropdown-item" href="jobnotice.html">공모전/채용공고</a></li>
                                <li><a class="dropdown-item" href="lend.html">장비대여신청</a></li>
                            </ul>
                        </li>

                        <!-- Lang Translator -->   

                            <div class="head-convert" id="langSwitcher">
                              <button type="button" class="lang-toggle" aria-expanded="false" aria-controls="langMenu">
                                  <i class="bi bi-translate" aria-hidden="true"></i>
                                  <span class="lang-label">Language</span>
                                  <i class="bi bi-caret-down-fill" aria-hidden="true"></i>
                                </button>

                              <div class="list-convert" id="langMenu" role="menu" aria-label="Language menu">
                                  <ul>
                                    <li role="none"><a href="#none" id="lang_ko" role="menuitem">한국어</a></li>
                                    <li role="none"><a href="#none" id="lang_en" role="menuitem">English</a></li>
                                    <li role="none"><a href="#none" id="lang_ja" role="menuitem">日本語</a></li>
                                    <li role="none"><a href="#none" id="lang_zh-CN" role="menuitem">中文(简体)</a></li>
                                  </ul>
                              </div>
                            <div id="google_translate_element" class="offscreen"></div>
                    </ul>
                </div>
            </div>
        </nav>

        <style>
      .research-page{
        max-width: 1100px;
        margin: 0 auto;
        padding: 36px 20px 80px;
      }

      .crumbs ol{
        list-style:none; padding:0; margin: 0 0 18px;
        display:flex; gap:10px; flex-wrap:wrap;
        font-size: 14px;
      }
      .crumbs a{ text-decoration: underline; }

      .research-hero h1{
        font-size: 64px;
        letter-spacing: -0.5px;
        margin: 0 0 18px;
      }

      .research-hero h3,
      .flagship h3 { text-align: left; }

      .research-lead{
        max-width: 900px;
        color:#2a3b4c;
        font-size: 16px;
        line-height: 1.85;
      }

      .flagship{ margin-top: 70px; }
      .flagship h2{ font-size: 40px; margin: 0 0 18px; }

      .flagship-grid{
        display:grid;
        font-size: 20px;
        grid-template-columns: 1fr 1fr;
        gap: 22px;
      }

      .flagship-card{
        display:flex; 
        justify-content:center;
        align-items: center;
        text-align:center;
        line-height: 1.2;   

        min-height: 94px;
        padding: 22px 26px;
        border-radius: 6px;
        background: #0b5f8a; /* 학부 메인컬러로 교체 */
        color: #fff;
        font-size: 26px;
        text-decoration: none;
        box-shadow: 0 6px 18px rgba(0,0,0,.08);
      }
      .flagship-card:hover{ filter: brightness(0.96); }

      .pubs{ margin-top: 80px; }
      .pubs h2{ font-size: 40px; margin: 0 0 12px; }

      @media (max-width: 900px){
        .research-hero h1{ font-size: 44px; }
        .flagship-grid{ grid-template-columns: 1fr; }
        .flagship-card{ font-size: 22px; }
      }
      </style>

            <section class="people-detail-header-section text-center">
                <div class="section-overlay"></div>

                <div class="container">
                    <div class="row">

                        <div class="col-lg-12 col-12">
                            <h3 class="text-white">연구분야</h3>
                        </div>

                    </div>
                </div>
            </section>

<div class="container-xxl py-3"></div>

 <!-- Title + Intro -->
  <header class="flagship">
    <div class="col-lg-8 col-12 mx-auto">
        <h3 class="mb-4 text-start">Research at Yonsei Communication</h3>

          <h7>연세대학교 언론홍보영상학부의 주요 연구 분야는 급변하는 뉴미디어 테크놀로지를 매개로 이루어지는 공적 커뮤니케이션의 작동 원리와 사회적 파급효과를 규명하는 데 초점을 둡니다. 개인의 인지·정서·행동 수준에서부터 집단·여론·네트워크, 나아가 제도와 정책 환경에 이르기까지 다양한 층위에서 나타나는 커뮤니케이션 현상을 통합적으로 조망하며, 변화하는 미디어 생태계 속에서 커뮤니케이션이 형성·확산·수용·조정되는 과정을 다각도로 분석합니다.</h7>
          <p></p>
          <h7>특히 디지털 플랫폼과 소셜미디어 환경에서의 정보 확산과 의제 형성, 뉴스·정치 커뮤니케이션과 여론의 역학, 네트워크 구조와 상호작용이 초래하는 사회적 결과를 폭넓게 다룹니다. 동시에 저널리즘의 변화와 미디어 신뢰, 알고리즘 기반 추천시스템 및 개인화가 공론장에 미치는 영향, 광고·PR을 포함한 전략 커뮤니케이션의 효과와 윤리 등 현대 사회의 핵심 의제를 심층적으로 연구합니다. 더 나아가 건강·위기·위험 커뮤니케이션 등 시민의 삶의 질과 직결되는 영역에서도 실증적 근거에 기반한 진단과 대안 제시를 지속적으로 수행하고 있습니다.</h7>
          <p></p>
          <h7>아울러 본 학부는 실증적 커뮤니케이션 연구 방법론의 고도화를 연구 역량의 핵심 기반으로 삼고, 대규모 데이터와 계산사회과학적 접근을 활용한 정량 분석을 적극적으로 발전시켜 왔습니다. 온라인 콘텐츠 및 네트워크 데이터 분석, 실험 연구와 조사 연구의 설계·추정 기법을 정교화하는 한편, 다양한 방법을 융합한 혼합 방법론을 통해 복합적인 커뮤니케이션 현상을 보다 정확하게 설명하고 예측하는 연구를 추진합니다. 이러한 방법론적 강점을 토대로 디지털 전환, 플랫폼화, AI 기반 미디어 환경 등 커뮤니케이션 환경의 구조적 변화를 국내외 비교 관점에서 체계적으로 탐구하며, 학문적 성과를 사회적·정책적 함의로 확장하는 연구를 지속적으로 확대하고 있습니다.</h7>

    </div>
  </header>

  <!-- Flagship Areas -->
  <section class="flagship">
    <div class="col-lg-8 col-12 mx-auto">
        <h3 class="mb-4 text-start">Flagship Research Areas</h3>

    <div class="flagship-grid">
      <a class="flagship-card" href="#democracy">Journalism, Democracy, & Society</a>
      <a class="flagship-card" href="#crisis">Crisis & Strategic Communication</a>
      <a class="flagship-card" href="#digital">Digital Technology, Platform, & AI</a>
      <a class="flagship-card" href="#health">Media Psychology, Health, & Well-Being</a>
    </div>
  </div>
  </section>

<header class="flagship">
  <div class="container-xxl py-3"></div>

  <div class="col-lg-8 col-12 mx-auto">
    <h3 class="mb-4 text-start d-inline ms-2">International Research Network</h3><h6 class="d-inline ms-2"><small> |  recent 5 years</small></h6>
    <p></p>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
      /* 지도 컨테이너 스타일 */
      #network-map {
        width: 100%;
        height: 600px; /* 고정 높이 설정 */
        background-color: #f8f9fa;
        border-radius: 8px;
        border: 1px solid #ddd;
        z-index: 1; /* 다른 UI 요소와의 겹침 방지 */
      }

      /* 팝업 스타일 커스텀 */
      .leaflet-popup-content-wrapper {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 13px;
      }
    </style>

    <div id="network-map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
      // 지도 초기 설정 (중심점 및 확대 레벨)
      // 1. 지도 초기화 및 배경 설정
        const map = L.map('network-map').setView([25, 10], 2);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; CARTO'
        }).addTo(map);

        // 2. 데이터 로드 및 마커 렌더링
        // network_map.json 파일을 불러와서 지도에 표시
        fetch('./data/network_map.json')
            .then(response => response.json())
            .then(data => {
                data.countries.forEach(item => {
                    const isHome = item.homeCountry;
                    
                    // 마커 크기 및 색상 설정
                    const markerOptions = {
                        radius: isHome ? 18 : Math.max(item.weight * 120, 10),
                        fillColor: isHome ? "#FF8C00" : "#2A5CA8",
                        color: "#FFFFFF",
                        weight: 1.5,
                        fillOpacity: 0.6
                    };

                    const marker = L.circleMarker([item.latitude, item.longitude], markerOptions).addTo(map);

                    // 팝업 내용 조립
                    let popupContent = `<div style="min-width:180px;"><strong>${item.countryName}</strong>`;
                    if (item.subdivisionName) popupContent += ` (${item.subdivisionName})`;
                    
                    // 파이썬에서 추가된 institutions 리스트가 있다면 표시
                    if (item.institutions && item.institutions.length > 0) {
                        popupContent += `<ul style="margin:8px 0 0 0; padding-left:18px; font-size:12px; list-style-type:square;">`;
                        item.institutions.forEach(inst => {
                            popupContent += `<li>${inst}</li>`;
                        });
                        popupContent += `</ul>`;
                    }
                    popupContent += `</div>`;

                    marker.bindPopup(popupContent);
                    
                    // 마우스 오버 시 상호작용
                    marker.on('mouseover', function() { this.openPopup(); this.setStyle({fillOpacity: 0.9}); });
                    marker.on('mouseout', function() { this.closePopup(); this.setStyle({fillOpacity: 0.6}); });
                });
            });

      // JSON 데이터 Fetch
      const jsonUrl = "data/network_map.json";

      fetch(jsonUrl)
        .then(response => {
          if (!response.ok) {
            throw new Error('데이터 응답 상태 이상 (Status: ' + response.status + ')');
          }
          return response.json();
        })
        .then(data => {
          console.log("협력 네트워크 데이터를 성공적으로 불러왔습니다.");
          renderMarkers(data);
        })
        .catch(error => {
          console.error('Fetch error:', error);
          // 실제 운영 환경에서는 alert 대신 부드러운 UI 알림을 권장합니다.
          console.log("지도 데이터를 불러오는 중 오류가 발생했습니다.");
        });
    </script>
  </div>
</header>

  <!-- Publications (existing accordion you already have) -->
  <section class="pubs">
    <div class="col-lg-8 col-12 mx-auto">
        <h3 class="mb-4 text-start d-inline ms-2">Major Research Outputs</h3><h6 class="d-inline ms-2"><small> |  from 2010</small></h6>
    <p></p>

    <div class="pub-topbar mb-3">
      <div class="d-flex gap-2 align-items-center flex-wrap">
        <label class="pub-meta mb-0" for="yearSelect">연도</label>
        <select id="yearSelect" class="form-select form-select-sm" style="width:140px">
          <option value="all">전체</option>
        </select>

        <label class="pub-meta mb-0 ms-2" for="sortSelect">정렬</label>
        <select id="sortSelect" class="form-select form-select-sm" style="width:160px">
          <option value="new">최신순</option>
          <option value="old">오래된순</option>
          <option value="title">제목순</option>
        </select>
      </div>

      <input id="searchInput" class="form-control form-control-sm search" placeholder="검색 (제목)" />
    </div>

    <div id="pubStatus" class="mb-2 pub-meta"></div>

    <div id="pubAccordion" class="accordion"></div>

    <div id="pubError" class="mt-3"></div>
  </main>

<script>
  // ===============================
  // Publications page (2000+)
  // Data file: data/pure_publications_2000plus.json
  // ===============================

  // ---- GitHub Pages(프로젝트 페이지)에서도 안전한 base 경로 ----
  function repoBase() {
    const parts = location.pathname.split('/').filter(Boolean);
    const isGithubIo = location.hostname.endsWith('github.io');

    // github.io 프로젝트 페이지: /REPO/xxx.html
    // github.io 유저/조직 페이지: /xxx.html (parts.length == 1)
    if (isGithubIo && parts.length >= 2) return `/${parts[0]}`;
    return '';
  }
  const BASE = repoBase();

  function urlFromRepo(path) {
    const clean = String(path || '').replace(/^\/+/, '');
    const p = BASE ? `${BASE}/${clean}` : clean; // 커스텀 도메인에서는 BASE=''
    return encodeURI(p);
  }

  // ---- Helpers ----
  function esc(s){
    return String(s ?? '').replace(/[&<>"]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]));
  }
  function isoToYmd(iso){
    const m = String(iso||'').match(/^(\d{4})-(\d{2})-(\d{2})/);
    return m ? `${m[1]}-${m[2]}-${m[3]}` : (iso||'');
  }
  function joinAuthors(authors){
    if (!Array.isArray(authors) || !authors.length) return '';
    // 너무 길면 약간 줄임(원하면 제한 수 변경 가능)
    const max = 12;
    const a = authors.slice(0, max);
    return a.join(', ') + (authors.length > max ? ', et al.' : '');
  }
  function doiHref(doi){
    const d = String(doi||'').trim();
    if (!d) return '';
    if (/^https?:\/\//i.test(d)) return d;
    return `https://doi.org/${d}`;
  }
  // ---- Highlight authors (원하는 이름들만 여기에) ----
  const HIGHLIGHT_AUTHORS = new Set([
    'Joohan Kim',
    'Kyungmo Kim',
    'Chang Hoan Cho',
    'Yong Chan Kim',
    'Namkee Park',
    'Young Min Baek',
    'Sang Yup Lee',
    'Jiyeon So',
    'Jarim Kim',
    'Hyunjin Song',
    'Na Yeon Lee',
    'Yoon Hi Sung',
    'Sukyoung Choi',
    'Jihyun Esther Paik',
    'Yoonmo Sang'
    // 필요하면 계속 추가
  ].map(n => normName(n)));

  function normName(s){
    return String(s || '')
      .toLowerCase()
      .replace(/\s+/g, ' ')
      .replace(/[()]/g, '')
      .trim();
  }

  // "Last, First" 형태까지 최대한 매칭되게 보정
  function nameVariants(raw){
    const s = String(raw || '').trim();
    const v = new Set([normName(s)]);
    if (s.includes(',')) {
      const parts = s.split(',').map(x => x.trim()).filter(Boolean);
      if (parts.length >= 2) v.add(normName(parts.slice(1).join(' ') + ' ' + parts[0])); // First Last
    }
    return v;
  }

  function isHighlightedAuthor(name){
    for (const v of nameVariants(name)) {
      if (HIGHLIGHT_AUTHORS.has(v)) return true;
    }
    return false;
  }

  function renderAuthors(authors){
    if (!Array.isArray(authors) || !authors.length) return '';
    const max = 12;
    const a = authors.slice(0, max);

    const html = a.map(name => {
      const safe = esc(name);
      return isHighlightedAuthor(name)
        ? `<span class="author-hl">${safe}</span>`
        : safe;
    }).join(', ');

    return html + (authors.length > max ? ', et al.' : '');
  }

  async function fetchJson(url){
    const res = await fetch(url, { cache: 'no-store' });
    if (!res.ok) throw new Error(`HTTP ${res.status} for ${url}`);
    return await res.json();
  }

  // ---- State ----
  let RAW = null;
  let ITEMS = [];   // normalized
  let YEARS = [];
  let FILTER = { year: 'all', q: '', sort: 'new' };

  const DATA_URL = urlFromRepo('data/pure_publications_2000plus.json');

  document.addEventListener('DOMContentLoaded', () => {
    init().catch(err => renderFatal(err));
  });

  function renderFatal(err){
    const box = document.getElementById('pubError');
    if (!box) return;
    box.innerHTML = `
      <div class="alert alert-danger">
        <strong>데이터를 불러오지 못했습니다.</strong><br>
        <code>${esc(err && err.message ? err.message : err)}</code><br>
        <div class="small mt-2">요청: <code>${esc(DATA_URL)}</code></div>
      </div>
    `;
  }

  async function init(){
    RAW = await fetchJson(DATA_URL);

    const arr =
      Array.isArray(RAW?.items) ? RAW.items :
      (Array.isArray(RAW?.channel?.items) ? RAW.channel.items : []);

    ITEMS = arr
      .map(it => {
        const date = it["dc:date"] || it.date || '';
        const m = String(date).match(/^(\d{4})-/);
        const year = it.year ?? (m ? Number(m[1]) : null);

        return {
          year,
          date,
          title: it.title || '',
          link: it.link || '',
          authors: Array.isArray(it.authors) ? it.authors : [],
          outlet: it.outlet || '',
          doi: it.doi || '',
          type: it.type || ''
        };
      })
      .filter(it => it.year && it.year >= 2000 && it.title && it.link)
      .sort((a,b) =>
        (b.year - a.year) ||
        String(b.date).localeCompare(String(a.date)) ||
        a.title.localeCompare(b.title)
      );

    YEARS = Array.from(new Set(ITEMS.map(it => it.year))).sort((a,b)=>b-a);

    buildYearSelect();
    wireControls();
    render();
  }

  function buildYearSelect(){
    const sel = document.getElementById('yearSelect');
    if (!sel) return;
    sel.innerHTML =
      `<option value="all">전체</option>` +
      YEARS.map(y => `<option value="${y}">${y}</option>`).join('');
  }

  function wireControls(){
    const yearSelect  = document.getElementById('yearSelect');
    const searchInput = document.getElementById('searchInput');
    const sortSelect  = document.getElementById('sortSelect');

    if (yearSelect) {
      yearSelect.addEventListener('change', () => {
        FILTER.year = yearSelect.value;
        render();
      });
    }

    if (sortSelect) {
      sortSelect.addEventListener('change', () => {
        FILTER.sort = sortSelect.value;
        render();
      });
    }

    if (searchInput) {
      let t = null;
      searchInput.addEventListener('input', () => {
        clearTimeout(t);
        t = setTimeout(() => {
          FILTER.q = (searchInput.value || '').trim().toLowerCase();
          render();
        }, 120);
      });
    }
  }

  function applyFilters(){
    const q = FILTER.q;
    const year = FILTER.year;

    let arr = ITEMS.slice();

    if (year !== 'all') {
      const y = Number(year);
      arr = arr.filter(it => it.year === y);
    }

    if (q) {
      arr = arr.filter(it => {
        const blob = [
          it.title,
          joinAuthors(it.authors),
          it.outlet,
          it.doi,
          it.type,
          isoToYmd(it.date)
        ].join(' ').toLowerCase();
        return blob.includes(q);
      });
    }

    // sort
    if (FILTER.sort === 'new') {
      arr.sort((a,b) => (b.year - a.year) || String(b.date).localeCompare(String(a.date)) || a.title.localeCompare(b.title));
    } else if (FILTER.sort === 'old') {
      arr.sort((a,b) => (a.year - b.year) || String(a.date).localeCompare(String(b.date)) || a.title.localeCompare(b.title));
    } else if (FILTER.sort === 'title') {
      arr.sort((a,b) => a.title.localeCompare(b.title) || (b.year - a.year) || String(b.date).localeCompare(String(a.date)));
    }

    return arr;
  }

  function groupByYear(arr){
    const map = new Map();
    for (const it of arr) {
      if (!map.has(it.year)) map.set(it.year, []);
      map.get(it.year).push(it);
    }
    const years = Array.from(map.keys()).sort((a,b)=>b-a);
    return { years, map };
  }

  function renderCitation(it){
    const authorsHtml = renderAuthors(it.authors);
    const year = it.year ? String(it.year) : '';
    const outlet = it.outlet ? `<em>${esc(it.outlet)}</em>` : '';
    const doi = String(it.doi||'').trim();
    const doiLink = doi ? `<a href="${esc(doiHref(doi))}" target="_blank" rel="noopener">https://doi.org/${esc(doi)}</a>` : '';
    const dateYmd = isoToYmd(it.date);

    // Univie 스타일 느낌: Authors (Year). Title. Outlet. DOI.
    const parts = [];
    if (authorsHtml) parts.push(`${authorsHtml}${year ? ` (${esc(year)})` : ''}.`);
    else if (year) parts.push(`(${esc(year)}).`);

    parts.push(`<a href="${esc(it.link)}" target="_blank" rel="noopener">${esc(it.title)}</a>.`);
    if (outlet) parts.push(`${outlet}.`);
    if (doiLink) parts.push(`${doiLink}.`);

    return `
      <div class="pub-cite">
        <div class="small text-muted mb-1">${esc(dateYmd)}</div>
        <div>${parts.join(' ')}</div>
      </div>
    `;
  }

  function render(){
    const statusEl = document.getElementById('pubStatus');
    const acc      = document.getElementById('pubAccordion');

    if (!statusEl || !acc) return;

    const filtered = applyFilters();
    const { years, map } = groupByYear(filtered);

    const qtxt = FILTER.q ? `, 검색어 "${esc(FILTER.q)}"` : '';
    const ytxt = FILTER.year === 'all' ? '전체' : FILTER.year;

    const rawGen = (RAW && RAW.generatedAt) || (RAW && RAW.channel && RAW.channel.lastBuildDate) || '';
    const gen = rawGen ? (String(rawGen).slice(0, 19) + 'Z') : '—';

    statusEl.innerHTML =
      `데이터: ${esc(ytxt)} / ${filtered.length.toLocaleString()}건${qtxt}
       <span class="ms-2 pub-count">(생성: ${esc(gen)})</span>`;

    if (!filtered.length) {
      acc.innerHTML = `<div class="alert alert-secondary">표시할 항목이 없습니다.</div>`;
      return;
    }

    const html = years.map((y, idx) => {
      const list = map.get(y) || [];
      const collapseId = `pubCollapse_${y}`;
      const headingId  = `pubHeading_${y}`;

      // 첫 해는 기본 open (단, 검색 중/전체 연도 필터 중이면 접힘)
      const show = (idx === 0 && !FILTER.q && FILTER.year === 'all') ? 'show' : '';
      const expanded = show ? 'true' : 'false';

      const itemsHtml = list.map(it => `
        <li class="list-group-item pub-item">
          ${renderCitation(it)}
        </li>
      `).join('');

      return `
        <div class="accordion-item">
          <h2 class="accordion-header" id="${headingId}">
            <button class="accordion-button ${show ? '' : 'collapsed'}" type="button"
                    data-bs-toggle="collapse" data-bs-target="#${collapseId}"
                    aria-expanded="${expanded}" aria-controls="${collapseId}">
              ${y} <span class="ms-2 pub-count">(${list.length.toLocaleString()}건)</span>
            </button>
          </h2>
          <div id="${collapseId}" class="accordion-collapse collapse ${show}" aria-labelledby="${headingId}" data-bs-parent="#pubAccordion">
            <div class="accordion-body p-0">
              <ul class="list-group list-group-flush">
                ${itemsHtml}
              </ul>
            </div>
          </div>
        </div>
      `;
    }).join('');

    acc.innerHTML = html;
  }
</script>
</section>

<footer class="site-footer">
            <div class="container">
                <div class="row">
                    <div class="col-lg-3 col-12 mb-4">
                        <img src="images/logo.png" class="logo img-fluid" alt="">
                    </div>

                    <div class="col-lg-4 col-md-6 col-12 mb-4">
                        <h5 class="site-footer-title mb-3">Quick Links</h5>

                        <ul class="footer-menu">
                            <li class="footer-menu-item"><a href="https://portal.yonsei.ac.kr/" class="footer-menu-link">학사포털</a></li>
                            <li class="footer-menu-item"><a href="https://socsci.yonsei.ac.kr/socsci/index.do" class="footer-menu-link">사회과학대학</a></li>
                            <li class="footer-menu-item"><a href="https://library.yonsei.ac.kr/" class="footer-menu-link">학술문화처 도서관</a></li>
                            <li class="footer-menu-item"><a href="https://ys.learnus.org/" class="footer-menu-link">LearnUS</a></li>
                            <li class="footer-menu-item"><a href="https://career.yonsei.ac.kr/nonIndex.do" class="footer-menu-link">Career Center</a></li>
                            <li class="footer-menu-item"><a href="https://counsel.yonsei.ac.kr/ysclinic/index.do" class="footer-menu-link">Counseling Center</a></li>
                        </ul>
                    </div>

                    <div class="col-lg-4 col-md-6 col-12 mx-auto">
                        <h5 class="site-footer-title mb-3">Contact Infomation</h5>

                        <p class="text-white mb-2 d-flex align-items-center">
                          <i class="bi-telephone me-2"></i>
                          <a href="tel:02-2123-2935" class="site-footer-link me-3 ms-3">
                             학부: 02-2123-2935
                          </a>
                          <span class="text-white me-3">|</span>
                          <a href="tel:02-2123-2970" class="site-footer-link">
                            대학원: 02-2123-2970
                          </a>
                        </p>

                        <p class="text-white mb-2 d-flex align-items-center">
                          <i class="bi-envelope me-2"></i>
                          <a href="mailto:masscomm@yonsei.ac.kr" class="site-footer-link me-3 ms-3">
                             masscomm@yonsei.ac.kr
                          </a>
                          <span class="text-white me-3">|</span>
                          <a href="mailto:gradcomm@yonsei.ac.kr" class="site-footer-link">
                             gradcomm@yonsei.ac.kr
                          </a>
                        </p>

                        <p class="text-white d-flex mt-3">
                            <i class="bi-geo-alt me-2"></i>
                            서울 서대문구 연세로 50, 언론홍보영상학부 (연희관 214호)
                        </p>

                    </div>
                </div>
            </div>

            <div class="site-footer-bottom">
                <div class="container">
                    <div class="row">

                        <div class="col-lg-6 col-md-7 col-12">
                            <p class="copyright-text mb-0">Copyright © 2025 Department of Communication, Yonsei University.<br>
                            Design: <a href="https://hyunjinsong.com" target="_blank">Hyunjin (Jin) Song</a>, based on <a href="https://templatemo.com" target="_blank">TemplateMo</a></p>
                        </div>
                        
                        <div class="col-lg-6 col-md-5 col-12 d-flex justify-content-center align-items-center mx-auto">
                            <ul class="social-icon">
                                <li class="social-icon-item">
                                    <a href="#" class="social-icon-link bi-twitter"></a>
                                </li>

                                <li class="social-icon-item">
                                    <a href="#" class="social-icon-link bi-facebook"></a>
                                </li>

                                <li class="social-icon-item">
                                    <a href="#" class="social-icon-link bi-instagram"></a>
                                </li>

                                <li class="social-icon-item">
                                    <a href="#" class="social-icon-link bi-linkedin"></a>
                                </li>

                                <li class="social-icon-item">
                                    <a href="https://youtube.com/templatemo" class="social-icon-link bi-youtube"></a>
                                </li>
                            </ul>
                        </div>
                        
                    </div>
                </div>
            </div>
        </footer>

        <!-- JAVASCRIPT FILES -->
        <script src="js/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <script src="js/jquery.sticky.js"></script>
        <script src="js/click-scroll.js"></script>
        <script src="js/counter.js"></script>
        <script src="js/custom.js"></script>
        <script src="js/langswitcher.js"></script>

    </body>
</html>